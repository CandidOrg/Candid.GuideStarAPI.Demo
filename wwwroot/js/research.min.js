function GetYearList(){let n=[],t=[];if(findocs.fin990s)for(let i=0;i<findocs.fin990s.length;i++)n.push("9-"+new Date(findocs.fin990s[i].period_end).getFullYear()),t.push(GenerateBalanceSheet(findocs.fin990s[i],"9"));n=n.filter((n,t,i)=>i.indexOf(n)==t).sort(function(n,t){return t.substring(2)-n.substring(2)});var i=$(".fiscal-year-select")[0];for(let t=0;t<n.length;t++)$(i).append('<option value="'+n[t]+'">'+n[t].substring(2)+"<\/option>");$.when(...t).then(function(...n){n.forEach(function(n){$("#balance-sheet-list").append(n[0])});$("#fiscal-year-select").trigger("change");$("#loadingSpinner").hide();$("#app").show()});n.length||$("#fiscal-year-select").hide()}function GenerateBalanceSheet(n,t){return $.ajax({method:"POST",url:"/premier/GetFinTable",data:{orgData:JSON.stringify(n),type:t},dataType:"html"})}var findocs;$(document).ready(function(){var n,r,i,t,u;$("#loadingSpinner").show();n=new Vue({el:"#app",filters:{json:n=>JSON.stringify(n,null,2),currency:n=>("$"+n+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},data:{verifiedOrg:{organization_id:null,organization_name:null,ein:null,city:null,logo_url:null,mission:null,website_url:null,gs_profile_update_level:null,gs_profile_update_level_logo:null,financials:{most_recent_year_financials:{fiscal_year:null,data_source:null,assets_total:null,revenue_contributions:null,revenue_govt_grants:null,revenue_program_services:null,revenue_investments:null,revenue_special_events:null,revenue_sales:null,revenue_other:null,total_revenue:null,expense_administration:null,expense_program_services:null,expense_fundraising:null,expenses_total:null}},operations:{officers_directors_key_employees:[]}},currentLeader:{name:"",title:""},cc:{pub78_verified:null,most_recent_pub78:null,most_recent_irb:null,bmf_status:null,most_recent_bmf:null},researchJson:{},finJson:{},assLiabJson:{}},watch:{verifiedOrg:function(n){var u,e,t,f;for(n.ein!=null&&n.ein.length>0?$("#verifiedOrg").show():($("#verifiedOrg").hide(),$("#textData").hide(),$("#revenueChart").hide(),$("#assLibChart").hide()),n.financials.most_recent_year_financials.total_revenue!=null&&!isNaN(n.financials.most_recent_year_financials.total_revenue)&&n.financials.most_recent_year_financials.total_revenue>0?($("#textData").show(),$("#revenueChart").show(),i.series[0].setData([{name:"Contributions",y:n.financials.most_recent_year_financials.revenue_contributions},{name:"Govt Grants",y:n.financials.most_recent_year_financials.revenue_govt_grants},{name:"Investments",y:n.financials.most_recent_year_financials.revenue_investments},{name:"Other",y:n.financials.most_recent_year_financials.revenue_other},{name:"Program Services",y:n.financials.most_recent_year_financials.revenue_program_services},{name:"Sales",y:n.financials.most_recent_year_financials.revenue_sales},{name:"Special Events",y:n.financials.most_recent_year_financials.revenue_special_events}]),i.series[1].setData([{name:"Administration",y:n.financials.most_recent_year_financials.expense_administration},{name:"Fundraising",y:n.financials.most_recent_year_financials.expense_fundraising},{name:"Program Services",y:n.financials.most_recent_year_financials.expense_program_services}]),i.setTitle({text:"Most Recent ("+n.financials.most_recent_year_financials.fiscal_year+") Revenue and Expense Breakdown"})):($("#textData").hide(),$("#revenueChart").hide()),u=[],e=[],t=0;t<n.financials.f990_financials.length;t++)f=new Date(Date.parse(n.financials.f990_financials[t].period_begin)).getFullYear(),typeof f=="number"&&(u.push([f,n.financials.f990_financials[t].assets_total]),e.push([f,n.financials.f990_financials[t].liabilities_total]));u.length>0?(r.series[0].setData(u),r.series[1].setData(e),$("#assLibChart").show()):$("#assLibChart").hide()}},mounted:function(){t&&t>0&&$("#searchTerms").val(t)}});Highcharts.setOptions({lang:{decimalPoint:".",thousandsSep:","}});r=Highcharts.chart("assLibChart",{chart:{type:"area"},title:{text:"Assets vs Liabilities Over Time"},tooltip:{pointFormat:"{series.name}: <b>${point.y:,.0f}<\/b>"},xAxis:{allowDecimals:!1,labels:{formatter:function(){return this.value}}},yAxis:{title:{text:"USD"},labels:{formatter:function(){return this.value>999?"$"+u(this.value/1e3)+"k":"$"+this.value}}},plotOptions:{series:{fillOpacity:.2},area:{marker:{enabled:!1,symbol:"circle",radius:2,states:{hover:{enabled:!0}}}}},series:[{name:"Assets",color:"#6fcd5e",data:[]},{name:"Liabilities",color:"#e03737",data:[]}]});i=Highcharts.chart("revenueChart",{chart:{type:"pie",margin:[0,0,0,0],spacingTop:0,spacingBottom:0,spacingLeft:0,spacingRight:0},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%<\/b>"},plotoptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}<\/b>: {point.percentage:.1f} %",style:{color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"}}},size:"100%"},title:{text:"Most Recent Revenue and Expense Breakdown"},series:[{name:"Revenue",size:150,center:["25%","50%"],data:[]},{name:"Expense",size:150,center:["75%","50%"],data:[]}]});$("#searchTerms").keyup(function(n){n.keyCode===13&&$("#searchButton").click()});t=$("#searchTerms").val();$("#searchButton").on("click",function(){t=$("#searchTerms").val();var i=t;$.ajax({method:"GET",url:"/premier/get",data:{ein:""+i},dataType:"json",beforeSend:function(){$("#loadingSpinner").show()},success:function(t){$("#loadingSpinner").hide();t.code===200?(n.researchJson=t,n.finJson={financials:t.data.financials},n.verifiedOrg=t.data.summary,n.verifiedOrg.financials=t.data.financials,n.verifiedOrg.operations=t.data.operations,n.currentLeader.name=t.data.operations.leader_name,n.currentLeader.title=t.data.operations.officers_directors_key_employees[0].title,n.cc=t.data.charitycheck):($("#errorMessage").html(t.message),$("#errorModal").modal("show"),console.dir(t));findocs={fin990s:t.data.financials.f990_financials,finPFs:t.data.financials.pf990_financials,finEZs:t.data.financials.f990ez_financials};GetYearList()},error:function(n,t){$("#loadingSpinner").hide();console.log("Error when doing /api/search request");console.log(t);console.dir(n);console.dir(t)}})});$('[tool-tip-toggle="tooltip-json"]').tooltip({placement:"left"});$("#researchRawJson").on("click",function(){$("#rawJson").html(jsonPrettyPrint.toHtml(n.researchJson));$("#rawJsonModal").modal("show")});$("#revenueRawJson").on("click",function(){$("#rawJson").html(jsonPrettyPrint.toHtml(n.finJson));$("#rawJsonModal").modal("show")});$("#assLibRawJson").on("click",function(){$("#rawJson").html(jsonPrettyPrint.toHtml(n.assLiabJson));$("#rawJsonModal").modal("show")});u=function(n){var t=n.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")};t?$("#searchButton").click():$("#loadingSpinner").hide();$("#fiscal-year-select").change(function(){$(".fiscal-year-details").hide();$("#year-"+$(this).val()).show()})});